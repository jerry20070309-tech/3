<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>TRIDENT V48 PRO</title>
<style>
body{background:#000;color:#0f0;font-family:monospace;padding:20px}
button{padding:10px 20px;background:#0f0;color:#000;font-weight:bold}
.card{border:1px solid #222;padding:10px;margin:6px 0}
.score{float:right}
.log{position:fixed;right:20px;top:20px;width:280px;height:400px;
border:1px solid #333;padding:10px;overflow:auto;background:#111}
</style>
</head>
<body>

<h2>TRIDENT V48 PRO</h2>
<button onclick="ignite()">å•Ÿå‹•æƒæ</button>

<div id="progress" style="height:4px;background:#222;margin:10px 0;">
<div id="bar" style="height:4px;width:0%;background:#0f0;"></div>
</div>

<div id="list"></div>

<div class="log">
<b>Signal Log</b>
<div id="log"></div>
</div>

<script>

const FULL_SCAN_LIMIT = 400
const ACTIVE_SCAN_LIMIT = 100
const REFRESH_INTERVAL = 30000

let universe = []
let activeSymbols = []
let market = {}
let ws = null
let alerted = new Set()

// ğŸ”¥ ç¬¬ä¸€æ¬¡æŠ“ 400 éš»
async function loadFullUniverse(){

const res = await fetch("https://fapi.binance.com/fapi/v1/ticker/24hr")
const data = await res.json()

universe = data
.filter(d=>d.symbol.endsWith("USDT"))
.sort((a,b)=>b.quoteVolume-a.quoteVolume)
.slice(0,FULL_SCAN_LIMIT)
.map(d=>d.symbol)

console.log("FULL:",universe.length)
}

// ğŸ”¥ æ¯ 30 ç§’åªæŒ‘å‰ 100
function updateActiveList(){
activeSymbols = universe.slice(0,ACTIVE_SCAN_LIMIT)
}

// ğŸ”¥ åˆå§‹åŒ– 100 éš»
async function initActiveSymbols(){

for(let s of activeSymbols){

const k = await fetch(
`https://fapi.binance.com/fapi/v1/klines?symbol=${s}&interval=15m&limit=50`
).then(r=>r.json())

const closes = k.map(x=>parseFloat(x[4]))

const slope = closes[49] - closes[0]
const avg = closes.reduce((a,b)=>a+b,0)/closes.length

market[s] = {
price: closes[49],
slope,
avg,
score: calcScore(slope,closes[49],avg)
}

}
}

// ğŸ”¥ è¨ˆåˆ†
function calcScore(slope,price,avg){

let score = 0

if(slope>0) score+=30
if(price>avg) score+=30
if(slope>avg*0.01) score+=40

return score
}

// ğŸ”¥ åªè¨‚é–±å‰100
function startWS(){

if(ws) ws.close()

const streams = activeSymbols
.map(s=>s.toLowerCase()+"@ticker")
.join("/")

ws = new WebSocket(
`wss://fstream.binance.com/stream?streams=${streams}`
)

ws.onmessage = e=>{
const data = JSON.parse(e.data).data
if(market[data.s]){
market[data.s].price = parseFloat(data.c)
}
}
}

// ğŸ”¥ ç•«é¢
function render(){

const list = document.getElementById("list")
list.innerHTML=""

Object.entries(market)
.sort((a,b)=>b[1].score-a[1].score)
.forEach(([s,d])=>{

const div=document.createElement("div")
div.className="card"
div.innerHTML=`${s}<span class="score">${d.score}</span>`
list.appendChild(div)

if(d.score>=90 && !alerted.has(s)){
logSignal(s,d.score)
alerted.add(s)
}

})

}

// ğŸ”¥ è¨Šè™Ÿè¨˜éŒ„
function logSignal(symbol,score){
const log=document.getElementById("log")
const div=document.createElement("div")
div.innerText="ğŸ”¥ STRONG ENTRY "+symbol+" "+score
log.prepend(div)
}

// ğŸ”¥ é€²åº¦æ¢
function startProgress(){
let elapsed=0
setInterval(()=>{
elapsed+=100
let percent=(elapsed/REFRESH_INTERVAL)*100
if(percent>=100) elapsed=0
document.getElementById("bar").style.width=percent+"%"
},100)
}

// ğŸ”¥ ä¸»æµç¨‹
async function ignite(){

await loadFullUniverse()   // 400 éš»åªä¸€æ¬¡

updateActiveList()         // å–å‰100
await initActiveSymbols()
startWS()
render()
startProgress()

setInterval(async ()=>{

updateActiveList()
await initActiveSymbols()
render()

},REFRESH_INTERVAL)

}

</script>
</body>
</html>
