<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>‚ö° SNIPER V13.1 | AUTO-HUNT</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;800&display=swap');
        body { background: #020202; color: #FFD700; font-family: 'JetBrains Mono', monospace; overflow: hidden; }
        .card { background: #0a0a0a; border: 1px solid #1a1a1a; transition: 0.2s; position: relative; }
        .hunt-card { border: 2px solid #ff0000; background: #2a0000 !important; animation: pulse 0.8s infinite; }
        .pinned { border: 2px solid #3b82f6 !important; background: #081221 !important; opacity: 1 !important; }
        @keyframes pulse { 0% { box-shadow: 0 0 10px #ff0000; } 50% { box-shadow: 0 0 20px #ff0000; } 100% { box-shadow: 0 0 10px #ff0000; } }
        .tag { padding: 1px 4px; border-radius: 2px; font-size: 8px; font-weight: bold; }
        .tag-sat { background: #22c55e; color: #000; }
        #logBox::-webkit-scrollbar { width: 4px; }
        #logBox::-webkit-scrollbar-thumb { background: #333; }
    </style>
</head>
<body class="h-screen flex flex-col text-[10px]">

    <header class="p-4 border-b border-yellow-900 bg-black flex justify-between items-center shrink-0">
        <div class="flex items-center gap-4">
            <h1 class="text-2xl font-black text-yellow-500 italic">‚ö° SNIPER V13.1</h1>
            <div id="modeStatus" class="bg-zinc-900 px-3 py-1 rounded text-zinc-500 font-bold border border-zinc-800 italic">ÊéÉÊèèÂæÖÂëΩ‰∏≠...</div>
        </div>
        <div class="flex gap-4">
            <button id="sysBtn" onclick="toggleSystem()" class="bg-blue-600 text-white px-10 py-1 rounded font-black hover:bg-blue-500 transition-all">START RADAR</button>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden">
        <main class="flex-1 p-3 overflow-y-auto bg-black">
            <div id="dashboard" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3"></div>
        </main>

        <aside class="w-80 border-l border-yellow-900 bg-zinc-950 flex flex-col shrink-0">
            <div class="p-3 border-b border-zinc-800 text-red-500 font-bold uppercase">Êà∞È¨•Êó•Ë™å (Â∑®ÈØ®/ÁàÜÂÄâ)</div>
            <div id="logBox" class="flex-1 overflow-y-auto p-2 space-y-1 font-mono"></div>
        </aside>
    </div>

<script>
    let isRunning = false;
    let stats = {}, pinned = new Set();
    let prevOI = {}; 
    const SCORE_THRESHOLD = 75; // 75ÂàÜËá™ÂãïÂÆöÈÅ∏ÈñÄÊ™ª
    const WHALE_MIN = 50000; 

    function checkDateMode() {
        const day = new Date().getDay();
        const status = document.getElementById('modeStatus');
        if (day === 6) {
            status.innerText = "üìÖ ÈÄ±ÂÖ≠Ê®°ÂºèÔºöÊï∏ÊìöÂ∞àÂ±¨Ê≠∏Â±¨";
            status.classList.replace('text-zinc-500', 'text-green-500');
            return "SAT";
        }
        return "NORMAL";
    }

    async function scan() {
        if(!isRunning) return;
        try {
            // ‰∏ÄÊ¨°ÊäìÂèñÂÖ®Â∏ÇÂ†¥ Ticker Êï∏ÊìöÔºåÁØÄÁúÅ API Ê∂àËÄó
            const res = await fetch('https://fapi.binance.com/fapi/v1/ticker/24hr');
            const data = await res.json();
            
            data.forEach(t => {
                const s = t.symbol;
                if (!s.endsWith('USDT')) return;

                const price = parseFloat(t.lastPrice);
                const vol24h = parseFloat(t.quoteVolume);
                const change = parseFloat(t.priceChangePercent);
                
                // --- 75ÂàÜË©ïÂàÜÈÇèËºØ (Ê†πÊìö‰Ω†ÁöÑÈúÄÊ±Ç‰øÆÊ≠£) ---
                let score = 0;
                if (Math.abs(change) > 2.5) score += 30; // Ê≥¢ÂãïÂàÜ
                if (vol24h > 50000000) score += 25; // Êàê‰∫§ÈáèÂàÜ
                const highLowRange = (parseFloat(t.highPrice) - parseFloat(t.lowPrice)) / price;
                if (highLowRange < 0.015) score += 20; // ËìÑÂã¢ÂàÜ
                if (change > 0) score += 10; // Ë∂®Âã¢ÂàÜ

                // --- B2 ÊåÅÂÄâÊ®°Êì¨Ë®àÁÆó (OI ËÆäÂãï) ---
                const currentOI = vol24h / price; 
                const oiDiff = prevOI[s] ? currentOI - prevOI[s] : 0;
                prevOI[s] = currentOI;

                stats[s] = { s, price, change, score, vol24h, oiDiff };

                // --- [Ëá™ÂãïÂÆöÈÅ∏ÈÇèËºØ] ---
                if (score >= SCORE_THRESHOLD && !pinned.has(s)) {
                    pinned.add(s);
                    addLog(s, `üéØ Ë©ïÂàÜÈÅîÊ®ô ${score.toFixed(0)} ÂàÜÔºåËá™ÂãïÂÆöÈÅ∏Áõ£Êéß`);
                }
            });

            render();
        } catch (e) { console.error("API Ê¥®Âá∫ÈåØ‰∫Ü:", e); }
        if(isRunning) setTimeout(scan, 3000);
    }

    function render() {
        const dashboard = document.getElementById('dashboard');
        const mode = checkDateMode();
        
        // ÈÅéÊøæÂá∫ 75 ÂàÜ‰ª•‰∏äÊàñË¢´ÂÆöÈÅ∏ÁöÑ
        const list = Object.values(stats)
            .filter(x => x.score >= SCORE_THRESHOLD || pinned.has(x.s))
            .sort((a,b) => (pinned.has(b.s) - pinned.has(a.s)) || (b.score - a.score));

        dashboard.innerHTML = list.slice(0, 16).map(x => {
            const isPinned = pinned.has(x.s);
            const isHighAlert = x.score >= 90;
            
            return `
                <div class="card p-3 rounded-lg ${isHighAlert ? 'hunt-card' : ''} ${isPinned ? 'pinned' : ''}" onclick="togglePin('${x.s}')">
                    <div class="flex justify-between items-center mb-2">
                        <div class="flex gap-1">
                            ${mode === 'SAT' ? '<span class="tag tag-sat">SAT</span>' : ''}
                            <span class="bg-zinc-800 text-white px-1 rounded">SCORE: ${x.score.toFixed(0)}</span>
                        </div>
                        <span class="${x.oiDiff >= 0 ? 'text-green-500' : 'text-red-500'} font-bold">B2: ${x.oiDiff > 0 ? '‚ñ≤' : '‚ñº'}</span>
                    </div>
                    <div class="flex justify-between items-end">
                        <h2 class="text-2xl font-black text-white">${x.s.replace('USDT','')}</h2>
                        <div class="text-right">
                            <div class="text-lg font-bold ${x.change >= 0 ? 'text-green-500' : 'text-red-500'}">${x.change}%</div>
                            <div class="text-zinc-500 font-mono">$${x.price.toLocaleString()}</div>
                        </div>
                    </div>
                    <div class="mt-2 pt-2 border-t border-zinc-900 flex justify-between text-[8px] text-zinc-500 font-bold">
                        <span>VOL: ${(x.vol24h/1000000).toFixed(1)}M</span>
                        <span class="${isHighAlert ? 'text-red-500 animate-bounce' : ''}">${isHighAlert ? 'üö® Â∑®ÈØ®Áï∞Âãï' : 'Áõ£Êéß‰∏≠'}</span>
                    </div>
                    ${isPinned ? '<div class="absolute -top-1 -right-1">üìå</div>' : ''}
                </div>
            `;
        }).join('');
    }

    function addLog(s, msg) {
        const logBox = document.getElementById('logBox');
        const div = document.createElement('div');
        div.className = "p-2 bg-zinc-900 border-l-2 border-blue-500 mb-1 text-zinc-400";
        div.innerHTML = `<span class="text-zinc-600">[${new Date().toLocaleTimeString()}]</span> <b>${s}</b>: ${msg}`;
        logBox.prepend(div);
    }

    function toggleSystem() {
        isRunning = !isRunning;
        const btn = document.getElementById('sysBtn');
        btn.innerText = isRunning ? "STOP RADAR" : "START RADAR";
        btn.className = isRunning ? "bg-red-600 text-white px-10 py-1 rounded font-black" : "bg-blue-600 text-white px-10 py-1 rounded font-black";
        if(isRunning) scan();
    }

    function togglePin(s) {
        pinned.has(s) ? pinned.delete(s) : pinned.add(s);
        render();
    }
</script>
</body>
</html>
