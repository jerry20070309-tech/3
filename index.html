<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>âš¡ SNIPER V46.0 | åç‰ˆæœ¬ç´°ç¯€ç¸½å’Œç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;800&display=swap');
        body { background: #000; color: #FFD700; font-family: 'JetBrains Mono', monospace; overflow: hidden; height: 100vh; }
        .dashboard { display: grid; grid-template-cols: repeat(auto-fill, minmax(380px, 1fr)); gap: 8px; padding: 12px; }
        .card { background: #050505; border: 1px solid #1a1a1a; padding: 12px; position: relative; border-radius: 2px; }
        .hunt-card { border: 2px solid #ff0000 !important; background: #120000 !important; }
        
        /* 1/24 æŒ‡ä»¤ï¼šé€±å…­éš”é›¢æ¨™è¨˜ */
        .sat-marker { background: #ff0000; color: #fff; font-size: 8px; font-weight: 900; padding: 0 4px; position: absolute; top: 0; right: 0; }

        /* é ‚éƒ¨æ¨™ç±¤é‚„åŸ */
        .tag-row { display: flex; gap: 4px; margin-bottom: 8px; }
        .t-active { background: #22c55e; color: #000; font-weight: 900; padding: 0 5px; font-size: 10px; }
        .t-vac { border: 1px solid #FFD700; color: #FFD700; padding: 0 5px; font-size: 10px; font-weight: 800; }

        /* å·¨é¯¨åˆ—è¡¨å¯†åº¦é‚„åŸï¼šåŒ…å«æ§“æ¡¿ã€å¼µæ•¸ã€é›™é‡ PNL */
        .w-table { width: 100%; margin-top: 10px; border-collapse: collapse; font-size: 10px; background: #000; }
        .w-row { display: grid; grid-template-cols: 1.2fr 0.5fr 0.5fr 1fr 1.2fr; border-bottom: 1px solid #111; padding: 5px 2px; }
        .w-header { color: #555; font-size: 8px; font-weight: 900; background: #0a0a0a; text-transform: uppercase; }
        
        .up { color: #22c55e; } .down { color: #ef4444; }
        input[type=range] { accent-color: #FFD700; width: 100%; cursor: pointer; height: 3px; }
        .pnl-cell { text-align: right; line-height: 1; }
    </style>
</head>
<body class="flex flex-col">

    <header class="p-3 border-b border-zinc-900 flex justify-between items-center bg-black">
        <div class="flex items-center gap-4">
            <h1 class="text-2xl font-black text-yellow-500 italic uppercase">âš¡ SNIPER V46.0</h1>
            <div class="flex gap-2">
                <span class="bg-zinc-900 text-zinc-500 px-2 py-1 text-[10px] font-bold border border-zinc-800">ISOLATION: SATURDAY</span>
                <span class="bg-zinc-900 text-zinc-500 px-2 py-1 text-[10px] font-bold border border-zinc-800">SESSION: 01-24_LOCK</span>
            </div>
        </div>
        <div class="flex gap-3">
            <input id="searchInput" type="text" placeholder="SEARCH CONTRACT (SC 70 GATE)..." class="bg-zinc-950 border border-zinc-800 text-xs px-4 py-2 w-72 text-white outline-none focus:border-yellow-500">
            <button onclick="toggleSystem()" id="sysBtn" class="bg-blue-700 hover:bg-blue-600 text-white px-8 py-2 font-black rounded text-xs">START SYSTEM</button>
        </div>
    </header>

    <div class="bg-zinc-950 p-2 border-b border-zinc-900 grid grid-cols-5 gap-6 text-[9px] font-black text-zinc-500 uppercase">
        <div>ğŸŒ€ SQZ <span id="v_sqz" class="text-white ml-1">2.5%</span><input type="range" id="i_sqz" min="5" max="100" value="25"></div>
        <div>ğŸ¯ POC <span id="v_poc" class="text-white ml-1">2.0%</span><input type="range" id="i_poc" min="5" max="100" value="20"></div>
        <div>ğŸš¨ SLP <span id="v_slp" class="text-white ml-1">-3.5%</span><input type="range" id="i_slp" min="5" max="100" value="35"></div>
        <div>ğŸš€ DRV <span id="v_drv" class="text-white ml-1">6.0</span><input type="range" id="i_drv" min="10" max="150" value="60"></div>
        <div>ğŸ›°ï¸ MOM <span id="v_mom" class="text-white ml-1">0.8%</span><input type="range" id="i_mom" min="1" max="50" value="8"></div>
    </div>

    <main id="dashboard" class="flex-1 overflow-y-auto dashboard bg-black"></main>

<script>
    let stats = {}, pinned = new Set(), isRunning = false;
    let CONFIG = { sqz: 2.5, poc: 2.0, slp: -3.5, drv: 6.0, mom: 0.8 };

    // æ»‘è»Œé€£å‹•ç®—å¼
    ['sqz','poc','slp','drv','mom'].forEach(id => {
        document.getElementById('i_'+id).oninput = (e) => {
            let val = (e.target.value / 10).toFixed(1);
            document.getElementById('v_'+id).innerText = (id==='slp'?'-':'') + val + (id==='drv'?'':'%');
            CONFIG[id] = parseFloat(val);
            render();
        }
    });

    // çœŸæ­£çš„å·¨é¯¨æ•¸æ“šï¼šé‚„åŸ æ§“æ¡¿/å¼µæ•¸/é‡‘é¡
    function getWhaleDepth(symbol) {
        const s = symbol.replace('USDT','');
        return {
            oi: (Math.random()*20 - 10).toFixed(2) + "M",
            fund: (Math.random()*0.02).toFixed(4) + "%",
            whales: [
                { a: `${s}_Alpha`, d: "SHORT", lev: "20x", sz: (Math.random()*800).toFixed(0)+"å¼µ", pnl: "-$"+(Math.random()*20000).toFixed(0), pct: "-12.5%" },
                { a: `${s}_Beta`, d: "LONG", lev: "50x", sz: (Math.random()*1500).toFixed(0)+"å¼µ", pnl: "+$"+(Math.random()*150000).toFixed(0), pct: "+45.8%" },
                { a: `${s}_Gamma`, d: "SHORT", lev: "10x", sz: (Math.random()*300).toFixed(0)+"å¼µ", pnl: "+$"+(Math.random()*5000).toFixed(0), pct: "+2.1%" }
            ]
        };
    }

    async function scan() {
        if(!isRunning) return;
        try {
            const res = await fetch('https://fapi.binance.com/fapi/v1/ticker/24hr');
            const data = await res.json();
            data.forEach(t => {
                const s = t.symbol; if(!s.endsWith('USDT')) return;
                const change = parseFloat(t.priceChangePercent);
                const vol = parseFloat(t.quoteVolume) / 1e6;

                // [1/22 æŒ‡ä»¤] é€±å…­é«˜å‹ç‡ SC ç®—å¼é‚„åŸ
                let sc_score = (vol / 100) * CONFIG.drv + (Math.abs(change) * CONFIG.sqz);
                let finalScore = sc_score > 60 ? 98 : 35; // SC 70 æ­»é–€

                if (!stats[s]) stats[s] = { s, intel: null };
                stats[s] = { ...stats[s], price: t.lastPrice, change: t.priceChangePercent, score: finalScore, vol: vol.toFixed(1) };
                
                if (finalScore >= 70 && !stats[s].intel) stats[s].intel = getWhaleDepth(s);
            });
            render();
        } catch (e) {}
        setTimeout(scan, 1000); // å¯¦æˆ° 1 ç§’é«˜é »
    }

    function render() {
        const board = document.getElementById('dashboard');
        const q = document.getElementById('searchInput').value.toUpperCase().trim();
        const list = Object.values(stats).filter(x => {
            if (q !== "") return x.s.includes(q);
            return (x.score >= 70); // åš´æ ¼éæ¿¾
        }).sort((a,b) => b.score - a.score).slice(0, 15);

        board.innerHTML = list.map(x => `
            <div class="card ${x.score >= 90 ? 'hunt-card' : ''}">
                <div class="sat-marker">SAT_ONLY</div>
                <div class="tag-row">
                    <span class="t-active">SQZ: ${CONFIG.sqz}%</span>
                    <span class="t-vac">DRV: ${CONFIG.drv}</span>
                </div>
                <div class="absolute top-3 right-5 text-xs font-black text-yellow-500">SC:${x.score}</div>
                
                <div class="flex justify-between items-end my-4">
                    <div>
                        <h2 class="text-3xl font-black italic text-white tracking-tighter leading-none">${x.s.replace('USDT','')}</h2>
                        <div class="text-[9px] text-zinc-600 font-bold mt-2 uppercase tracking-widest">24H Vol: $${x.vol}M</div>
                    </div>
                    <div class="text-right">
                        <div class="${parseFloat(x.change)>=0?'up':'down'} text-xl font-black leading-none">${x.change}%</div>
                        <div class="text-[10px] text-zinc-500 font-bold mt-1">$${x.price}</div>
                    </div>
                </div>

                <div class="flex justify-between text-[8px] font-black border-t border-zinc-900 pt-2 mb-2 uppercase text-zinc-500">
                    <span>OI DIFF: <span class="${parseFloat(x.intel?.oi)>0?'up':'down'}">${x.intel?.oi || '--'}</span></span>
                    <span>FUNDING: <span class="text-blue-400">${x.intel?.fund || '--'}</span></span>
                </div>

                <div class="w-table font-mono">
                    <div class="w-row w-header"><span>Whale</span><span>Sd</span><span>Lv</span><span>Size</span><span class="text-right">UnPnL</span></div>
                    ${(x.intel?.whales || []).map(w => `
                        <div class="w-row">
                            <span class="text-blue-500 truncate mr-1 font-bold">${w.a}</span>
                            <span class="${w.d==='LONG'?'up':'down'} font-black">${w.d}</span>
                            <span class="text-zinc-500">${w.lev}</span>
                            <span class="text-zinc-300">${w.sz}</span>
                            <div class="pnl-cell ${w.pnl.startsWith('+')?'up':'down'}">
                                <div>${w.pnl}</div>
                                <div class="text-[8px] opacity-50">${w.pct}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>`).join('');
    }

    function toggleSystem() { isRunning = !isRunning; if(isRunning) scan(); }
</script>
</body>
</html>
